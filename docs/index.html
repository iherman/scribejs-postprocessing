<!doctype html>
<html lang="en">
<head>
  <meta charset='utf-8'>
  <title>scribejs-resolutions 1.0.0 | Documentation</title>
  <meta name='description' content='Gathering resolutions from minutes generated by scribejs'>
  <meta name='viewport' content='width=device-width,initial-scale=1'>
  <link href='assets/bass.css' rel='stylesheet'>
  <link href='assets/style.css' rel='stylesheet'>
  <link href='assets/github.css' rel='stylesheet'>
  <link href='assets/split.css' rel='stylesheet'>
</head>
<body class='documentation m0'>
    <div class='flex'>
      <div id='split-left' class='overflow-auto fs0 height-viewport-100'>
        <div class='py1 px2'>
          <h3 class='mb0 no-anchor'>scribejs-resolutions</h3>
          <div class='mb1'><code>1.0.0</code></div>
          <input
            placeholder='Filter'
            id='filter-input'
            class='col12 block input'
            spellcheck='false'
            autocapitalize='off'
            autocorrect='off'
            type='text' />
          <div id='toc'>
            <ul class='list-reset h5 py1-ul'>
              
                
                <li><a
                  href='#main'
                  class="">
                  main
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#local_repos'
                  class="">
                  LOCAL_REPOS
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#github_repos'
                  class="">
                  GITHUB_REPOS
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#user_config_name'
                  class="">
                  USER_CONFIG_NAME
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#github_repos'
                  class="">
                  github_repos
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#local_repos'
                  class="">
                  local_repos
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#sort_resolutions'
                  class="">
                  sort_resolutions
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#filter_resolutions'
                  class="">
                  filter_resolutions
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#get_resolutions'
                  class="">
                  get_resolutions
                  
                </a>
                
                </li>
              
                
                <li><a
                  href='#collect_resolutions'
                  class="">
                  collect_resolutions
                  
                </a>
                
                </li>
              
            </ul>
          </div>
          <div class='mt1 h6 quiet'>
            <a href='https://documentation.js.org/reading-documentation.html'>Need help reading this?</a>
          </div>
        </div>
      </div>
      <div id='split-right' class='relative overflow-auto height-viewport-100'>
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='main'>
      main
    </h3>
    
    
  </div>
  

  <p>Entry point: a simple switch between handling local repos (see <a href="#local_repos">local_repos</a>) and github repos (see <a href="#github_repos">github_repos</a>).</p>
<p>The switch between local and github is based on the presence or not of the <code>-l</code> (or <code>--local</code>) flag.</p>

    <div class='pre p1 fill-light mt0'>main()</div>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='local_repos'>
      LOCAL_REPOS
    </h3>
    
    
  </div>
  

  <p>List of local repos to process when running the <a href="#local_repos">local_repos</a> function: each object has a field for the directory (<code>dir</code>), the folder used for the minutes themselves (<code>minutes</code>) and the reference to the current resolution file (<code>current</code>).</p>

    <div class='pre p1 fill-light mt0'>LOCAL_REPOS</div>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='github_repos'>
      GITHUB_REPOS
    </h3>
    
    
  </div>
  

  <p>List of github repos to process when running the <a href="#github_repos">github_repos</a> function: each object has a field for the repository (<code>owner</code> and <code>repo</code>), the folder used for the minutes themselves (<code>minutes</code>) and the reference to the current resolution file (<code>current</code>).</p>

    <div class='pre p1 fill-light mt0'>GITHUB_REPOS</div>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='user_config_name'>
      USER_CONFIG_NAME
    </h3>
    
    
  </div>
  

  <p>The name of the configuration file in the user’s home directory. It contains the user’s github API token (<code>ghtoken</code>),
necessary for committing the results on the github repository.</p>

    <div class='pre p1 fill-light mt0'>USER_CONFIG_NAME</div>
  
    <p>
      Type:
      <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">string</a>
    </p>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='github_repos'>
      github_repos
    </h3>
    
    
  </div>
  

  <p>The main processing for github repositories: for each repo in <a href="#github_repos">GITHUB_REPOS</a>:</p>
<ol>
<li>get the “current” list of resolution from the repo,</li>
<li>compare them to the list of minutes in the folder marked to contain the minutes</li>
<li>generate the missing set of resolutions by invoking <a href="#collect_resolutions">collect_resolutions</a> function on the list of minute references</li>
<li>merge the results with the “current” list</li>
<li>commit a new “current” list of resolution on the repo (making use of the user’s API)</li>
</ol>
<p>Access to the github repository (i.e., step 5 above) is based on the user’s API token, stored in the local configuration file (see <a href="#user_config_name">USER_CONFIG_NAME</a>)</p>

    <div class='pre p1 fill-light mt0'>github_repos()</div>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='local_repos'>
      local_repos
    </h3>
    
    
  </div>
  

  <p>The main processing for local repositories: for each repo in <a href="#local_repos">LOCAL_REPOS</a>:</p>
<ol>
<li>get the “current” list of resolution from the local repo,</li>
<li>compare them to the list of minutes in the folder marked to contain the minutes</li>
<li>generate the missing set of resolutions by invoking <a href="#collect_resolutions">collect_resolutions</a> function on the list of minute references</li>
<li>merge the results with the “current” list</li>
<li>overwrite the “current” list of resolution with the new content</li>
</ol>

    <div class='pre p1 fill-light mt0'>local_repos()</div>
  
  

  
  
  
  
  
  

  

  

  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='sort_resolutions'>
      sort_resolutions
    </h3>
    
    
  </div>
  

  <p>Compare resolution objects; to be used in a “sort” method on array of objects.</p>
<p>Sorting takes a decreasing order by year, a decreasing order by meeting date within a year, and finally an increasing order by resolution number</p>

    <div class='pre p1 fill-light mt0'>sort_resolutions(a: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>, b: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>): <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number">Number</a></div>
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>a</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</code>
	    
          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>b</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>)</code>
	    
          </div>
          
        </div>
      
    </div>
  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number">Number</a></code>:
        negative, zero, or positive, depending on the comparison result (see the Javascript “sort” method for details)

      
    
  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='filter_resolutions'>
      filter_resolutions
    </h3>
    
    
  </div>
  

  <p>Check whether the resolutions for minutes have already been handled in a previous run. Used to avoid unnecessary regeneration of data.</p>

    <div class='pre p1 fill-light mt0'>filter_resolutions(refs: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a>&#x3C;<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">String</a>>, current: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a>&#x3C;<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>>): <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a>&#x3C;<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">String</a>></div>
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>refs</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a>&#x3C;<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">String</a>>)</code>
	    Array of minute references (i.e., file names)

          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>current</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a>&#x3C;<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>>)</code>
	    Array of current resolution data objects

          </div>
          
        </div>
      
    </div>
  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a>&#x3C;<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">String</a>></code>:
        Array of minute references that must be handled

      
    
  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='get_resolutions'>
      get_resolutions
    </h3>
    
    
  </div>
  

  <p>Get the resolution for a minute text (in markdown). The function relies upon the scribejs format. It:</p>
<ul>
<li>extracts the URL and the date of the minutes from the preambles in JSON-LD</li>
<li>extracts the resolution summary lines</li>
<li>creates an array of resolution object, with the following keys: <code>year</code>, <code>date</code>, <code>number</code> (i.e., index of the resolution for one call), <code>text</code> (for the text of
the resolution) and the <code>url</code> into the relevant minutes.</li>
</ul>

    <div class='pre p1 fill-light mt0'>get_resolutions(minutes: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">String</a>): <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a>&#x3C;<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>></div>
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>minutes</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">String</a>)</code>
	    the minutes for a call, in markdown

          </div>
          
        </div>
      
    </div>
  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a>&#x3C;<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>></code>:
        resolution data for one call

      
    
  

  

  

  

  

  

  

  
</section>

          
        
          
          <section class='p2 mb2 clearfix bg-white minishadow'>

  
  <div class='clearfix'>
    
    <h3 class='fl m0' id='collect_resolutions'>
      collect_resolutions
    </h3>
    
    
  </div>
  

  <p>Collect all the resolutions. The function calls out, for each minute file, to the <a href="#get_resolutions">get_resolutions</a> functions,
and flattens all resolutions into a single large resolution. The set of resolution is also sorted (using <a href="#sort_resolutions">sort_resolutions</a>).</p>

    <div class='pre p1 fill-light mt0'>collect_resolutions(file_names: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a>&#x3C;<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">String</a>>, get_data: <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">Function</a>): <a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a>&#x3C;<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>></div>
  
  

  
  
  
  
  
  

  
    <div class='py1 quiet mt1 prose-big'>Parameters</div>
    <div class='prose'>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>file_names</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array">Array</a>&#x3C;<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String">String</a>>)</code>
	    List of the minute file names, i.e., the base name of the minute file in its repository

          </div>
          
        </div>
      
        <div class='space-bottom0'>
          <div>
            <span class='code bold'>get_data</span> <code class='quiet'>(<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function">Function</a>)</code>
	    A function returning the markdown content of the minutes in a Promise. The function itself either uses the local file system read or a fetch to the repository, depending on whether this function is called from 
<a href="#local_repos">local_repos</a>
 or 
<a href="#github_repos">github_repos</a>
, respectively.

          </div>
          
        </div>
      
    </div>
  

  

  
    
      <div class='py1 quiet mt1 prose-big'>Returns</div>
      <code><a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a>&#x3C;<a href="https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object">Object</a>></code>:
        Object consisting of two fields: the content of 
<code>file_names</code>
 (with the key 
<code>short_names</code>
) and the list of all the (new) resolutions (with the key 
<code>resolutions</code>
)

      
    
  

  

  

  

  

  

  

  
</section>

          
        
      </div>
    </div>
  <script src='assets/anchor.js'></script>
  <script src='assets/split.js'></script>
  <script src='assets/site.js'></script>
</body>
</html>
